---
title: "Networks, Ranking, and Feedback Loops"
subtitle: "Or, The Real Math Was The Friends We Made Along The Way"
author: "<br> Prof. <span class = 'author-highlight'>Phil Chodrow</span> <br> UCLA Department of Mathematics"    
date: "<br>May 27th, 2021"
output: 
  xaringan::moon_reader:  
    lib_dir: libs   
    css: ["../assets/shinobi.css", "../assets/ninpo.css",  "../assets/ninjutsu.css"] 
    seal: true   
    self_contained: false  
    nature: 
      ratio: "16:10"
      highlightStyle: github    
      highlightLines: true 
      countIncrementalSlides: false  
---
exclude: true
<style type="text/css">
code.r{ 
  font-size: 16px; 
}
pre {
  font-size: 16px !important;
}
</style>
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

---

class: bg-main1 
background-image: url("../img-shared/geo-intro.png")
background-size: contain
 

# My Journey

 
---
layout: true
class: split-two with-border middle

.column[
  .split-four[
  .row.bg-main1[.content.font2[
Quick overview of .alert[**networks**] and why we care about them.
  ]]
  .row.bg-main2[.content.font2[
.alert[**Ranking**] in networks. <br> (Here be linear algebra.)
  ]]
  .row.bg-main3[.content.font2[
From ranks to self-sustaining  <br>.alert[**feedback loops**]. 
  ]]
  .row.bg-main5[.content.font2[
.alert[**Having fun**] while doing science. 
  ]]
]]

.column[.content.center.vmiddle[
{{content}}
]]

---
class: hide-row2-col1 hide-row3-col1 hide-row4-col1
<img src="img/network.jpeg" width=100%>
***Image credit:*** *Wikipedia*
---
class: hide-row3-col1 hide-row4-col1
<img src="img/schematic.png" width=100%>
$$\left[\mathbf{D}^i + \mathbf{D}^o - (\mathbf{A} + \mathbf{A}^T) +\alpha \mathbf{I}\right]\mathbf{s} = \left[\mathbf{D}^i- \mathbf{D}^o \right]\mathbb{1}$$
---
class: hide-row4-col1
<img src="img/pnas.png" width=95%>
---
class:
<img src="img/heart-cookies.jpg" width=32%>
<img src="img/book.jpg" width=32%>
<img src="img/apollo.jpg" width=32%>
<img src="img/yes.GIF" width=65%>
<img src="img/so-pumped.png" width=32%>
<img src="img/ezra.jpg" width=32%>
<img src="img/cat.jpeg" width=32%>
<img src="img/page-rank.png" width=30%> 
---
class: fade-row2-col1 fade-row3-col1 fade-row4-col1
<img src="img/network.jpeg" width=100%>   
***Image credit:*** *Wikipedia*    

---
layout: false
class: split-two
  
.column.bg-main1[<br> <br>
.content.font3[.color-main1[Directed] Networks] 
.blockquote.font_large[A ***.alert2[network]*** (or ***.alert2[graph]***) consists of:
- A set $\mathcal{N}$ of entities, called *.alert2[nodes]*.
- A set of $\mathcal{E}$ of connections between pairs of nodes, called *.alert2[edges]*.]

.font_large[Social groups, complex infrastructure, and natural ecosystems are among the .alert[many] systems we can model with networks.]
]

.column[
.content.center.vmiddle[
<img src="img/network.jpeg" width=100%>   
***Image credit:*** *Wikipedia*
]
]

---
layout: true
class: split-two

.column[
  .split-four[
  .row.bg-main1[.content.font3[
.alert[Directed] Networks
  ]]
  .row.bg-main1[.content.font_large[
  .alert2[Competitions] (chess, basketball...)  <br> 
  .color-main1[tab] Nodes are competitors/teams. <br>
  .color-main1[tab] $A \rightarrow B$ $\implies$ $B$ beats $A$. 
  ]]
  .row.bg-main1[.content.font_large[ 
  .alert2[Internet] (Google, Facebook) <br>
  .color-main1[tab] Nodes are webpages. <br>
  .color-main1[tab] $A\rightarrow B$ $\implies$ $A$ links to $B$. 
  ]] 
  .row.bg-main1[.content.font_large[
  .alert2[Endorsements] (politics, Twitter) <br> 
  .color-main1[tab] Nodes are people. <br>
  .color-main1[tab] $A\rightarrow B$ $\implies$ $A$ thinks $B$ is good.   
  ]]
]]

.column[.content.center.hmiddle[<br>
<img src="img/digraph.png" width=70%><br>
***Image credit:*** *Wikipedia*
{{content}}
]]

---
class: hide-row2-col1 hide-row3-col1 hide-row4-col1 

---
class: hide-row3-col1 hide-row4-col1
<img src="img/magnus.jpeg" width=70%> 

---
class:hide-row4-col1
<img src="img/how-pagerank-works.png" width=70%>

---

class:
<img src="img/lamberson-social-network.jpeg" width=70%><br> 
***Image credit***: [PJ Lamberson](http://social-dynamics.org/twitter-network-data/)

---
layout: true
class: split-two with-border middle

.column[
  .split-four[
  .row.bg-main1[.content.font2[
Quick overview of .alert[networks] and why we care about them.
  ]]
  .row.bg-main2[.content.font2[
.alert[Ranking] in networks. <br> (Here be linear algebra.)
  ]]
  .row.bg-main3[.content.font2[
From ranks to self-sustaining  <br>.alert[feedback loops]. 
  ]]
  .row.bg-main5[.content.font2[
.alert[**Having fun**] while doing science. 
  ]]
]]

.column[.content.center.vmiddle[
{{content}}
]]

---
class: fade-row1-col1 fade-row3-col1 fade-row4-col1
<img src="img/schematic.png" width=100%>
$$\left[\mathbf{D}^i + \mathbf{D}^o - (\mathbf{A} + \mathbf{A}^T) +\alpha \mathbf{I}\right]\mathbf{s} = \left[\mathbf{D}^i- \mathbf{D}^o \right]\mathbb{1}$$

---
class: middle
layout: false

.split-two[
.column.bg-main1[
<br><br>
# The Network Ranking Problem

.blockquote.font_large[Given a network, assign a scalar .alert2[**rank**] or .alert2[**score**] vector $\mathbf{r} \in \mathbb{R}^n$ based on the network structure. $r_i$ is the rank of node $i \in \mathcal{N}$.    
]


.content.font_large[
1. Who is the **best** chessplayer? 
  - [Magnus Carlsen](https://twitter.com/MagnusCarlsen?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor)
2. Which website is **most central** to the internet?
  - [philchodrow.com](www.philchodrow.com)
3. What is the **most important** account on Twitter?
  - [No Context Star Trek](https://twitter.com/NoContextTrek)]
]
.column[
.content.center.vmiddle[
<img src="img/pagerank-example.jpeg" width=90%><br> 
***Image credit:*** *Wikipedia* 
]
]
]

---
class: 
layout: false

.split-two[ 
.column.bg-main1[
<br> <br> 
# The Adjacency Matrix <br> <br> 
.content.center[.font_large[ 
  $$\mathbf{A} = \left[\begin{matrix}
    <!-- 0 & \mathbf{1} & 0 & 0 & 0 & 0 \\  -->
    <!-- 0 & 0 & \mathbf{1} & 0 & 0 & 0 \\ -->
    <!-- 0 & 0 & 0 & 0 & \mathbf{1} & 0 \\ -->
    <!-- 0 & \mathbf{1} & 0 & 0 & 0 & 0 \\ -->
    <!-- 0 & 0 & 0 & \mathbf{1} & 0 & \mathbf{1} \\  -->
    <!-- 0 & 0 & 0 & 0 & 0 & 0  -->
    \end{matrix}\right] 
    $$
    
  Turns **.alert[network]** problems into **.alert2[linear algebra]** problems. 
  ]
  ]
]
.column[
.content.center.vmiddle[
<img src="img/digraph.png" width=90%><br> 
***Image credit:*** *Wikipedia*
]
]
]

---
layout: true
class: split-two

.column.bg-main1[
<br> <br> 
# Computing .alert[Ranks] <br> <br> 
.content.center[.font_large[ 
  $$\mathbf{A} = \left[\begin{matrix}
    <!-- 0 & \mathbf{1} & 0 & 0 & 0 & 0 \\  -->
    <!-- 0 & 0 & \mathbf{1} & 0 & 0 & 0 \\ -->
    <!-- 0 & 0 & 0 & 0 & \mathbf{1} & 0 \\ -->
    <!-- 0 & \mathbf{1} & 0 & 0 & 0 & 0 \\ -->
    <!-- 0 & 0 & 0 & \mathbf{1} & 0 & \mathbf{1} \\  -->
    <!-- 0 & 0 & 0 & 0 & 0 & 0  -->
    \end{matrix}\right] 
    $$
    Lots of ways to compute a rank vector $\mathbf{r} \in \mathbb{R}^n$...
  ]
  ]
]

.column[<br>
  .split-three[
  .row.bg-main4[.content.font_large[
  .alert2[Degree] (Number of positive interactions) 
  .color-main4[tab] $$\mathbf{r} = \mathbf{d} = \mathbf{e}^T\mathbf{A}$$ <br>
  ]]
  .row.bg-main4[.content.font_large[ 
  .alert2[PageRank] (Google) Leading eigenvector of 
  $$\mathbf{P} = \mathbf{D}^{-1}\mathbf{A} + \frac{1}{n}(1-\alpha)\mathbf{E}$$
  ]] 
  .row.bg-main4[.content.font_large[
  .alert2[SpringRank] (DeBacco et al. 2018) Solve linear system 
  .font_medium[.font_small[$$\left[\mathbf{D}^i + \mathbf{D}^o - (\mathbf{A} + \mathbf{A}^T) + \alpha\mathbf{I}\right]  \mathbf{r} = \left[\mathbf{D}^i - \mathbf{D}^o\right]\mathbf{e}$$]
  ]]]
]]


---
class: hide-row1-col2 hide-row2-col2 hide-row3-col2 

---
class: hide-row2-col2 hide-row3-col2


---
class:hide-row3-col2 

---
class: 

---
layout: false
class: bg-main1

# .alert2[Example]: PageRank in *Hamilton* mention network

.content.center[
<img src="img/hamilton.png" width=85%><br> 

.font2[Leading eigenvector of 
$\mathbf{P} = \mathbf{D}^{-1}\mathbf{A} + \frac{1}{n}(1-\alpha)\mathbf{E}$.]
]


---
layout: true
class: split-two with-border middle

.column[
  .split-four[
  .row.bg-main1[.content.font2[
Quick overview of .alert[networks] and why we care about them.
  ]]
  .row.bg-main2[.content.font2[
.alert[Ranking] in networks. <br> (Here be linear algebra.)
  ]]
  .row.bg-main3[.content.font2[
From ranks to self-sustaining  <br>.alert[feedback loops]. 
  ]]
  .row.bg-main5[.content.font2[
.alert[**Having fun**] while doing science. 
  ]]
]]

.column[.content.center.vmiddle[
{{content}}
]]

---
class: fade-row1-col1 fade-row2-col1 fade-row4-col1
<img src="img/pnas.png" width=95%>

---

class: split-two bg-main1
layout: false

.column[
<br> 
.font_large[.font_large[.font_large[
.content.center[Ranks .alert2[⟳] Decisions]]]
]
.blockquote[
.content.font_large[.content.font_large[
  What happens when network ranks .alert2[inform] decision-making within a    system?]
]]
]




.column.bg-main4[.content.center[<br><br><br><br>
  <img src="img/us-news-rankings.jpeg" width=60%> 
  ]
  .content.font_large[.alert2[Example]: 
  College ranks are based on selectivity. 
  
  High ranks <br>  $\implies$ more applications <br> $\implies$     higher selectivity <br> $\implies$ even higher ranks....
]]



---
class: split-50 bg-main1 
layout: false 

.row[ 
.split-four[
.column[.image-caption-right[
  <br> 
  ## .alert[<nobr>Mari Kawakatsu</nobr>]
  .font_medium[Applied and Computational Mathematics <br> Princeton University ]
  ]    
]
.column[.image-bottom[
  <img src="img/mari_portrait.jpeg" width=100%> 
]]
.column[  
.image-bottom[
  <img src="img/phil_portrait.jpeg" width=100%>
]  
] 
.column[.image-caption-left[
  <br>
  ## .alert[<nobr>Phil Chodrow</nobr>]
  .font_large[Mathematics <br> UCLA]
  ] 
]
]
]

.row[
.split-four[
.column[.image-caption-right[
  ## .alert[<nobr>Nicole Eikmeier</nobr>]
  .font_large[<nobr>Computer Science</nobr> <br> Grinnell]      
  ]   
]
.column[
  <img src="img/nicole_portrait.jpeg" width=100%> 
]
.column[    
  <img src="img/dan_portrait.jpeg" width=100%>
] 
.column[.image-caption-left[
  ## .alert[<nobr>Dan Larremore</nobr>]
  .font_large[<nobr>Computer Science</nobr> <br> CU Boulder ]
  ] 
]
]
]

---

class: split-two bg-main1

# Working Environment (.alert2[Very Important]) 

.content.font2[Complex Networks Winter Workshop 2019 (\#CNWW)]

.column[.content.center[<br><br><br><br><br><br><br><br>
  <img src="img/monastere.jpeg" width=100%> 
  
  .content.font_medium[Le Monastère des Augustines, Québec City]
]]
.column[.content.center[<br><br><br><br><br><br><br><br>
  <img src="img/cats-2.jpeg" width=97%> 
  
  .content.font_medium[Cafe Felin Ma Langue Aux Chats (yes, it's a .alert[cat cafe]])
]]


---

class: split-two bg-main1

.column[.content[
<br> 
.font_large[.content.center[.font_large[.font_large[The Model]]] <br>

Matrix $\mathbf{A} = \mathbf{A}^{(t)}$ of *endorsements*: $a_{ij}^{(t)}$ is the weighted number of times $i$ endorses $j$ by time $t$. 

1. Compute rank vector $\mathbf{r} = \sigma(\mathbf{A})$ (degree, PageRank, SpringRank...)
2. Each node $i$ computes a *utility* of endorsing $j$:  $$u_{ij} = \color{#63d297}{\beta_1} r_j + \color{#ff5252}{\beta_2} (r_j - r_i)^2\;.$$ 

$\color{#63d297}{\beta_1}$ : Preference for *prestige*. <br>
$\color{#ff5252}{\beta_2}$ : Preference for *proximity*. 
]]]

.column.bg-main4[.content.vmiddle[
<img src="img/fig_1.png" width=100%> 
]]

---

class: split-two bg-main1

.column[.content[
<br> 
.font_large[.content.center[.font_large[.font_large[The Model]]] <br>


3\. Node $i$ endorses node $j$ with probability $$p_{ij} =    \frac{e^{u_{ij}}}{\sum_k e^{u_{ik}}}\;.$$

4\. Matrix $\mathbf{A}$ updated with .alert2[new endorsements]: 

$$\mathbf{A}^{(t+1)} = \color{#ff5252}{\lambda} \mathbf{A}^{(t)} + (1-\color{#ff5252}{\lambda}) \color{#63d297}{\mathbf{\Delta}^{(t)}}$$

$\lambda$ is a .alert[memory parameter]: $\lambda \approx 1 \rightarrow$ system evolves slowly. 

]]]

.column.bg-main4[.content.vmiddle[
<img src="img/fig_1.png" width=100%> 
]]

---

class: split-two bg-main1

.column[.content[
<br> 
.font_large[.font_large[.font_large[
.center[Ranks .alert2[⟳] Decisions]
]]

.blockquote[Agents develop prestige by receiving endorsements.
]

.blockquote[Agents make endorsement decisions based on prestige. 
]
]]]

.column.bg-main4[.content.vmiddle[
<img src="img/fig_1.png" width=100%> 
]]




